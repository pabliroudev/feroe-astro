---
import BaseLayout from '../layouts/BaseLayout.astro';
import PageHeader from '../components/PageHeader.astro';
---
<BaseLayout title="Contacto" description="Contacto y sedes (si aplica) de FEROE.">
  <PageHeader
    title="Contacto"
    description="Formulario y datos de contacto. (Contenido y sedes por definir.)"
  />

  <section class="section">
    <div class="container">
      <div class="grid cols-2">
        <div class="card">
          <h2 class="h2">Escríbenos</h2>
          
          <form class="grid" id="contacto-form" method="post" action="/api/contacto">
  <!-- Honeypot anti-spam -->
  <input
    type="text"
    name="web"
    tabindex="-1"
    autocomplete="off"
    aria-hidden="true"
    style="position:absolute; left:-9999px; width:1px; height:1px;"
  />

  <div>
    <label for="nombre">Nombre</label>
    <input id="nombre" name="nombre" autocomplete="name" placeholder="Tu nombre" required />
  </div>

  <div>
    <label for="email">Email</label>
    <input id="email" name="email" type="email" autocomplete="email" placeholder="tu@email.com" required />
  </div>

  <div>
    <label for="asunto">Asunto</label>
    <input id="asunto" name="asunto" placeholder="Ej. propuesta, prensa, afiliación..." />
  </div>

  <div>
    <label for="mensaje">Mensaje</label>
    <textarea id="mensaje" name="mensaje" placeholder="Tu mensaje..." required></textarea>
  </div>

  <button class="btn primary" type="submit">Enviar</button>

  <p id="contacto-status" class="muted" style="font-size: 13px; margin: 0;"></p>
</form>

<script>
  const form = document.getElementById("contacto-form");
  const statusEl = document.getElementById("contacto-status");

  if (!(form instanceof HTMLFormElement)) {
    console.warn("No se encontró el formulario #contacto-form");
  } else if (!(statusEl instanceof HTMLElement)) {
    console.warn("No se encontró el elemento #contacto-status");
  } else {
    form.addEventListener("submit", async (e) => {
      e.preventDefault();
      statusEl.textContent = "Enviando…";

      const res = await fetch(form.action, { method: "POST", body: new FormData(form) });
      const json = await res.json().catch(() => ({}));

      if (res.ok && json.ok) {
        form.reset();
        statusEl.textContent = "Mensaje enviado. Gracias.";
      } else {
        statusEl.textContent = json.error || "No se pudo enviar el mensaje.";
      }
    });
  }
</script>


        </div>

        <div class="card">
          <h2 class="h2">Datos</h2>
          <p class="muted" style="margin-top:0">
            Añadiremos correo general, teléfonos, horario y sedes.
          </p>

          <div class="card" style="box-shadow:none">
            <div class="pill">Email (placeholder)</div>
            <p class="muted" style="margin:10px 0 0">contacto@feroe.org</p>
          </div>

          <div class="card" style="box-shadow:none; margin-top:12px">
            <div class="pill">Sedes</div>
            <p class="muted" style="margin:10px 0 0">Por definir</p>
          </div>
        </div>
      </div>
    </div>
  </section>
</BaseLayout>
